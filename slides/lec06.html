<!DOCTYPE html>
<html lang="en"><head>
<script src="lec06_files/libs/clipboard/clipboard.min.js"></script>
<script src="lec06_files/libs/quarto-html/tabby.min.js"></script>
<script src="lec06_files/libs/quarto-html/popper.min.js"></script>
<script src="lec06_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lec06_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lec06_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lec06_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lec06_files/libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="lec06_files/libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Dr.&nbsp;Thomas Ranner (Tom)">
  <title>COMP2870 Theoretical Foundations of Computer Science II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lec06_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lec06_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="lec06_files/libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link href="lec06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lec06_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lec06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lec06_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script>
    MathJax = {
      tex: {
        tags: 'ams'  // should be 'ams', 'none', or 'all'
      }
    };
  </script>
  <script type="module" src="lec06_files/libs/quarto-ojs/quarto-ojs-runtime.js"></script>
  <link href="lec06_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">COMP2870 Theoretical Foundations of Computer Science II</h1>
  <p class="subtitle">Complex matrices and vectors</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Thomas Ranner (Tom) 
</div>
<div class="quarto-title-author-email">
<a href="mailto:T.Ranner@leeds.ac.uk">T.Ranner@leeds.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            School of Computer Science, University of Leeds
          </p>
    </div>
</div>

</section>
<section>
<section id="complex-vectors-and-matrices" class="title-slide slide level2 center">
<h2>Complex vectors and matrices</h2>
<div id="def-complex-vectors-matrices" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> &nbsp;</p>
<ul>
<li>A complex matrix is a matrix whose entries are complex numbers.</li>
<li>A complex vector is a vector whose entries are complex numbers.</li>
</ul>
</div>
<aside class="notes">
<p>Last year you were introduced to vectors of real numbers. In the remaining part of Linear Algebra, we will need to work with complex matrices and vectors. The definitions are mostly what you would expect but with some slight subtleties.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hermitian-product" class="slide level3">
<h3>Hermitian product</h3>
<p>We write <span class="math inline">\(\langle \vec{a}, \vec{b} \rangle\)</span> for the Hermitian product of two complex <span class="math inline">\(n\)</span>-vectors <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span> and the value is given by <span class="math display">\[\begin{equation}
\label{eq:hermitian-product}
\langle \vec{a}, \vec{b} \rangle = \sum_{i=1}^n a_i \bar{b}_i.
\end{equation}\]</span></p>
<ul>
<li>We see that the Hermitian product is the same as taking the scalar product of <span class="math inline">\(\vec{a}\)</span> and the complex conjugate of <span class="math inline">\(\vec{b}\)</span>.</li>
<li>If the entries in <span class="math inline">\(\vec{b}\)</span> are all real numbers, then the Hermitian product of <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span> is equal to the scalar product of <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span>.</li>
</ul>
</section>
<section id="example" class="slide level3">
<h3>Example</h3>
<p>Find the Hermitian product of <span class="math inline">\(\vec{a} = (1 + 2i, 2 + i, 3 - 4i)^T\)</span> and <span class="math inline">\(\vec{b} = (6 + 2i, 3 + 4i, 1 + i)\)</span>.</p>
<aside class="notes">
<p>Let <span class="math inline">\(\vec{a} = (1 + 2i, 2 + i, 3 - 4i)^T\)</span> and <span class="math inline">\(\vec{b} =
(6 + 2i, 3 + 4i, 1 + i)^T\)</span> then: <span class="math display">\[\begin{align*}
\langle \vec{a}, \vec{b} \rangle
&amp; = (1 + 2i) \times (6 - 2i) + (2 + i) \times (3 - 4i) + (3 - 4i) \times (1 - i)
\\
&amp; = (10 + 10i) + (10 - 5i) + (-1 - 7i) = 19 - 2i.
\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="exercise" class="slide level3">
<h3>Exercise</h3>
<p>Find the Hermitian product of <span class="math inline">\(\vec{c} = (3 + i, -2 + 2i, 4 - i)^T\)</span> and <span class="math inline">\(\vec{d}
= (-1 + 3i, 2 + 6i, 2i)^T\)</span>.</p>
</section>
<section id="euclidean-norm-of-a-complex-vector" class="slide level3">
<h3>Euclidean norm of a complex vector</h3>
<p>For a complex vector, we define the Euclidean norm as <span class="math display">\[\begin{align*}
\| \vec{z} \| = \sqrt{ \sum_{i=1}^n |z_i|^2 } = \sqrt{ \langle z, z \rangle }.
\end{align*}\]</span></p>
<aside class="notes">
<p><span class="math display">\[\begin{align*}
\langle \vec{z}, \vec{z} \rangle
= \sum_{i=1}^n z_i \bar{z}_i = \sum_{i=1}^n |z_i|^2.
\end{align*}\]</span> So for a complex vector, we define the Euclidean norm as <span class="math display">\[\begin{align*}
\| \vec{z} \| = \sqrt{ \sum_{i=1}^n |z_i|^2 } = \sqrt{ \langle z, z \rangle }.
\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="orthogonal-vectors" class="slide level3">
<h3>Orthogonal vectors</h3>
<p>We say two vectors are <strong>orthogonal</strong> if their Hermitian product is 0.</p>
<p><strong>Example.</strong></p>
<p>The vectors <span class="math inline">\((1, 2, 3)^T\)</span> and <span class="math inline">\((-3, -6, 5)^T\)</span> are orthogonal.</p>
</section>
<section id="matrices-and-inner-products" class="slide level3">
<h3>Matrices and inner products</h3>
<div id="lem-transpose-inner-product" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1</strong></span> Let <span class="math inline">\(\vec{x}, \vec{y}\)</span> be <span class="math inline">\(n\)</span>-vectors (with real entries) and <span class="math inline">\(A\)</span> an <span class="math inline">\(n \times
n\)</span> matrix (with real entries). Then <span class="math display">\[
A \vec{x} \cdot \vec{y} = \vec{x} \cdot A^T \vec{y}.
\]</span> Moreover, if <span class="math inline">\(A\)</span> is symmetric (<span class="math inline">\(A^T = A\)</span>), then <span class="math display">\[
A \vec{x} \cdot \vec{y} = \vec{x} \cdot A \vec{y}.
\]</span></p>
</div>
<aside class="notes">
<p>Recall that for a real <em>symmetric</em> <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> and any <span class="math inline">\(n\)</span>-vectors <span class="math inline">\(\vec{x}\)</span> and <span class="math inline">\(\vec{y}\)</span> that <span class="math display">\[\begin{align*}
A \vec{x} \cdot \vec{y}
&amp; = \sum_{i=1}^n (A \vec{x})_i y_i &amp;&amp; \text{(definition of scalar product)} \\
&amp; = \sum_{i=1}^n \left( \sum_{j=1}^n A_{ij} x_j \right) y_i
&amp;&amp; \text{(definition of matrix-vector product)} \\
&amp; = \sum_{i=1}^n \sum_{j=1}^n A_{ji} x_j y_i
&amp;&amp; \text{(symmetry of $A$)} \\
&amp; = \sum_{j=1}^n x_j \sum_{i=1}^n \left(A_{ji} y_i \right)
&amp;&amp; \text{(rearranging)} \\
&amp; = \sum_{j=1}^n x_j (A y)_j
&amp;&amp; \text{(definition of matrix-vector product)} \\
&amp; = \vec{x} \cdot A \vec{y}
&amp;&amp; \text{(definition of scalar product)}.
\end{align*}\]</span></p>
<p>Replacing all terms with complex value and the scalar product with the Hermitian product, we get a similar calculation: <span class="math display">\[\begin{align*}
\langle A \vec{x}, \vec{y} \rangle
&amp; = \sum_{i=1}^n (A \vec{x})_i \bar{y}_i &amp;&amp;
\text{(definition of Hermitian product)} \\
&amp; = \sum_{i=1}^n \left( \sum_{j=1}^n A_{ij} x_j \right) \bar{y}_i
&amp;&amp; \text{(definition of matrix-vector product)} \\
&amp; = \sum_{i=1}^n \sum_{j=1}^n A_{ji} x_j \bar{y}_i
&amp;&amp; \text{(symmetry of $A$)} \\
&amp; = \sum_{j=1}^n x_j \sum_{i=1}^n \left(A_{ji} \bar{y}_i \right)
&amp;&amp; \text{(rearranging)} \\
&amp; = \sum_{j=1}^n x_j \bar{(\bar{A} y)}_j
&amp;&amp; \text{(definition of matrix-vector product)} \\
&amp; = \langle \vec{x}, \bar{A} \vec{y} \rangle
&amp;&amp; \text{(definition of Hermitian)}.
\end{align*}\]</span> This is quite unsatisfactory (note the extra bar on <span class="math inline">\(A\)</span> in the final equation), and we would like something that generalises the idea of a symmetric matrix to the Hermitian product case too.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="what-about-for-the-hermitian-product" class="slide level3">
<h3>What about for the Hermitian product?</h3>
<div id="lem-hermitian-inner-product" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2</strong></span> Let <span class="math inline">\(\vec{x}, \vec{y}\)</span> be complex <span class="math inline">\(n\)</span>-vectors and <span class="math inline">\(A\)</span> an <span class="math inline">\(n \times n\)</span> complex matrix. Then <span class="math display">\[
\langle A \vec{x}, \vec{y} \rangle
= \langle \vec{x},  \bar{A}^T \vec{y} \rangle.
\]</span></p>
</div>
</section>
<section id="hermitian-matrix" class="slide level3">
<h3>Hermitian matrix</h3>
<div id="def-hermitian-matrix" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> For a complex <span class="math inline">\(n\)</span>-matrix <span class="math inline">\(A\)</span>, we write <span class="math inline">\(A^H\)</span> for the <strong>conjugate transpose</strong> (also called the <strong>Hermitian transpose</strong>) given by <span class="math display">\[\begin{equation*}
(A^H)_{ij} = \bar{A}_{ji} = (\bar{A}^T)_{ij}.
\end{equation*}\]</span> If <span class="math inline">\(A^H = A\)</span>, then we say that <span class="math inline">\(A\)</span> is <strong>Hermitian</strong>.</p>
</div>
<p>Repeating the above calculations, we can see that if <span class="math inline">\(A\)</span> is Hermitian then <span class="math display">\[\begin{equation*}
\langle A \vec{x}, \vec{y} \rangle = \langle \vec{x}, A \vec{y} \rangle.
\end{equation*}\]</span></p>
</section></section>
<section>
<section id="back-to-the-eigenvalue-problem" class="title-slide slide level2 center">
<h2>Back to the eigenvalue problem</h2>
<p>Finding numbers <span class="math inline">\(\lambda\)</span> (eigenvalues) and vectors <span class="math inline">\(\vec{x}\)</span> (eigenvectors) which satisfy the equation: <span class="math display">\[\begin{equation}
A \vec{x} = \lambda \vec{x}.
\end{equation}\]</span></p>
<aside class="notes">
<p>We saw one starting point for finding eigenvalues is to find the roots of the characteristic equation: a polynomial of degree <span class="math inline">\(n\)</span> for an <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span>. However, we have already seen that this approach will be infeasible for large matrices. Instead, we will find a sequence of similar matrices to <span class="math inline">\(A\)</span> such that we can read off the eigenvalues from the final matrix.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="matrix-formulation" class="slide level3">
<h3>Matrix formulation</h3>
<div id="lem-matrix-form" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3</strong></span> Let <span class="math inline">\(A\)</span> be an <span class="math inline">\(n \times n\)</span> matrix with <span class="math inline">\(n\)</span> (distinct) eigenvalues and <span class="math inline">\(n\)</span> eigenvectors. <!-- Label the eigenvectors by --> <!-- $\vec{x}_{1}, \ldots \vec{x}_{n}$ and the eigenvalues $\lambda_1, \ldots --> <!-- \lambda_n$. --> Let <span class="math inline">\(S\)</span> be the matrix whose columns are the eigenvectors and <span class="math inline">\(\Lambda\)</span> the diagonal matrix whose entries are the correspond eigenvalues. Then <span class="math display">\[\begin{equation}
\label{eq:SLamSinv}
A S = S \Lambda.
\end{equation}\]</span></p>
</div>
<aside class="notes">
<p>This formula shows another factorisation of the matrix <span class="math inline">\(A\)</span> into simpler matrices, very much like we had when we computed the LU-factorisation matrix.</p>
<p>This is an example of <strong>similar matrices</strong> - matrices that have the same eigenvalues</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="similar-matrices" class="slide level3">
<h3>Similar matrices</h3>
<div id="def-similar" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> We say two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are <strong>similar</strong> if there exists an invertible matrix <span class="math inline">\(P\)</span> such that <span class="math display">\[
P B = A P.
\]</span></p>
</div>
<aside class="notes">
<p>So <span class="math inline">\(A\)</span> is similar to <span class="math inline">\(\Lambda\)</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-1" class="slide level3">
<h3>Example</h3>
<p>The matrices <span class="math display">\[\begin{equation*}
A = \begin{pmatrix}
1 &amp; 0 \\ 0 &amp; 2
\end{pmatrix}
\quad \text{and} \quad
B = \begin{pmatrix}
1 &amp; -2 \\ 0 &amp; 2
\end{pmatrix}
\end{equation*}\]</span> are similar.</p>
<aside class="notes">
<p>Let <span class="math inline">\(P = \begin{pmatrix} 1 &amp; 2 \\ 0 &amp; 2 \end{pmatrix}\)</span> then</p>
<p><span class="math display">\[\begin{align*}
P B = \begin{pmatrix}
1 &amp; 2 \\ 0 &amp; 4
\end{pmatrix} = A P.
\end{align*}\]</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="remark" class="slide level3">
<h3>Remark</h3>
<ul>
<li><p>Similar matrices represent the same linear transformation in different bases (coordinate systems).</p></li>
<li><p>The matrix <span class="math inline">\(P\)</span> is the <em>change of basis</em> matrix.</p></li>
<li><p>If one of the matrices is invertible, the other is also invertible.</p></li>
</ul>
</section>
<section id="key-theorem" class="slide level3">
<h3>Key theorem</h3>
<div id="thm-similar" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be similar matrices. Then <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> have the same eigenvalues.</p>
</div>
<aside class="notes">
<p>We start by writing <span class="math inline">\(B = P^{-1} A P\)</span>. Then we can compute that <span class="math display">\[\begin{equation}
\label{eq:Bsim-alt}
B P^{-1} = P^{-1} A.
\end{equation}\]</span> Let <span class="math inline">\(\lambda\)</span> be an eigenvalue of <span class="math inline">\(A\)</span> with eigenvector <span class="math inline">\(\vec{x}\)</span> and write <span class="math inline">\(\vec{y} = P^{-1} \vec{x}\)</span>. Then we have that <span class="math display">\[\begin{align*}
B \vec{y} &amp; = B P^{-1} \vec{x} &amp;&amp; \text{(definition of $\vec{y}$)} \\
&amp; = P^{-1} A \vec{x}  &amp;&amp; \text{(from \eqref{eq:Bsim-alt})} \\
&amp; = P^{-1} (\lambda \vec{x}) &amp;&amp; \text{(since $\vec{x}$ is an eigenvector)} \\
&amp; = \lambda P^{-1} \vec{x} &amp;&amp; \text{(rearranging)} \\
&amp; = \lambda \vec{y} &amp;&amp; \text{(definition of $\vec{y}$)}.
\end{align*}\]</span> This shows that any eigenvalue of <span class="math inline">\(A\)</span> is an eigenvalue of <span class="math inline">\(B\)</span>. It also gives a formula for how eigenvectors change between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>To show any eigenvalue of <span class="math inline">\(B\)</span> is an eigenvalue of <span class="math inline">\(A\)</span>, we repeat the calculation with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> swapped.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="using-eigenvalues-to-help" class="slide level3">
<h3>Using eigenvalues to help</h3>
<p>What about the other way round?</p>
<p>Are these matrices similar? <span class="math display">\[
A = \begin{pmatrix} 3 &amp; 1 \\ 0 &amp; 3 \end{pmatrix}
\quad\text{and}\quad
B =  \begin{pmatrix} 3 &amp; 0 \\ 0 &amp; 3 \end{pmatrix}.
\]</span></p>
<aside class="notes">
<p>We saw before the eigenvalues of <span class="math inline">\(A\)</span> are <span class="math inline">\(3\)</span> and <span class="math inline">\(3\)</span>. We can read off the eigenvalues of <span class="math inline">\(B\)</span> are also <span class="math inline">\(3\)</span> repeated.</p>
<p>Assume for contradiction that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are similar so <span class="math inline">\(P B = A P\)</span> for an invertible matrix <span class="math inline">\(P\)</span>. Let <span class="math inline">\(P = \begin{pmatrix} a &amp; b \\ c &amp; d \end{pmatrix}\)</span>$. Then <span class="math display">\[\begin{align*}
P B &amp; = \begin{pmatrix} 3 a &amp; 3 b \\ 3 c &amp; 3d \end{pmatrix} \\
A P &amp; = \begin{pmatrix} 3 a + c &amp; 3 b + d \\ 3c &amp; 3 d \end{pmatrix}.
\end{align*}\]</span> Equating components we see that <span class="math display">\[\begin{align*}
3 a &amp; = 3 a + c &amp;&amp; \Rightarrow c = 0 \\
3 b &amp; = 3 b + d &amp;&amp; \Rightarrow d = 0.
\end{align*}\]</span> This implies that <span class="math inline">\(P\)</span> has the form <span class="math display">\[\begin{align*}
P = \begin{pmatrix} a &amp; b \\ 0 &amp; 0 \end{pmatrix},
\end{align*}\]</span> and <span class="math inline">\(\det P = 0\)</span>. This contradicts that <span class="math inline">\(P\)</span> is invertible so <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not similar.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="using-eigenvalues-to-help-1" class="slide level3">
<h3>Using eigenvalues to help</h3>
<p>Suppose we have two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> of the same size which we can write as: <span class="math display">\[\begin{align*}
A S = S \Lambda \quad\text{and}\quad B R = R \Lambda.
\end{align*}\]</span> If <span class="math inline">\(R\)</span> is invertible, then <span class="math display">\[\begin{align*}
A S R^{-1} = S R^{-1} B.
\end{align*}\]</span> If <span class="math inline">\(S\)</span> is also invertible, then <span class="math inline">\(S R^{-1}\)</span> is also invertible and <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are similar.</p>
</section></section>
<section>
<section id="symmetric-matrices" class="title-slide slide level2 center">
<h2>Symmetric matrices</h2>
<div id="thm-symmetric" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> Let <span class="math inline">\(A\)</span> be a symmetric matrix with real entries. Then <span class="math inline">\(A\)</span> has <span class="math inline">\(n\)</span> real eigenvalues and any distinct eigenvalues are orthogonal.</p>
</div>
<aside class="notes">
<p>Let <span class="math inline">\(\lambda\)</span> be an eigenvalue of <span class="math inline">\(A\)</span> with eigenvector <span class="math inline">\(\vec{x}\)</span>. Recall that <span class="math inline">\(\vec{x} \neq 0\)</span>. Then, since <span class="math inline">\(A\)</span> has real values, we can compute that: <span class="math display">\[\begin{equation*}
\bar{(A \vec{x})}_i = \bar{\left(\sum_{j=1}^n A_{ji} x_i\right)}
= \sum_{j=1}^n A_{ji} \bar{x_i} = (A \bar{\vec{x}})_i.
\end{equation*}\]</span> We also note that any real, symmetric matrix is automatically Hermitian.</p>
<p>Then we see that <span class="math display">\[\begin{align*}
\lambda \langle \vec{x}, \vec{x} \rangle
&amp; = \langle (\lambda \vec{x}), \vec{x} \rangle
&amp;&amp; \text{(from definition of Hermitian product)}\\
&amp; = \langle (A \vec{x}), \vec{x} \rangle
&amp;&amp; \text{(definition of eigenvalue and eigenvector)} \\
&amp; = \langle \vec{x}, A \vec{x} \rangle
&amp;&amp; \text{(symmetry of $A$)} \\
&amp; = \langle \vec{x}, \lambda \vec{x} \rangle
&amp;&amp; \text{(definition of eigenvalue and eigenvector)} \\
&amp; = \bar{\lambda} \langle \vec{x}, \vec{x} \rangle
&amp;&amp; \text{(from definition of Hermitian product)}.
\end{align*}\]</span> Since, <span class="math inline">\(\langle \vec{x}, \vec{x} \rangle &gt; 0\)</span> (recall <span class="math inline">\(\vec{x} \neq 0\)</span>), we can divide by <span class="math inline">\(\langle \vec{x}, \vec{x} \rangle\)</span> so infer that <span class="math display">\[\begin{equation*}
\lambda = \bar{\lambda}.
\end{equation*}\]</span></p>
<p>Next, let <span class="math inline">\(\vec{x}\)</span> and <span class="math inline">\(\vec{y}\)</span> be eigenvectors of <span class="math inline">\(A\)</span> with distinct, eigenvalues <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mu\)</span>, respectively. From the first part of the proof, we know that <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mu\)</span> are real. We compute that <span class="math display">\[\begin{align*}
\lambda \langle \vec{x}, \vec{y} \rangle
&amp; = \langle \lambda \vec{x}, \vec{y} \rangle \\
&amp; = \langle A \vec{x}, \vec{y} \rangle \\
&amp; = \langle \vec{x}, A^H \vec{y} \rangle \\
&amp; = \langle \vec{x}, A \vec{y} \rangle \\
&amp; = \langle \vec{x}, \mu \vec{y} \rangle \\
&amp; = \bar{\mu} \langle \vec{x}, \vec{y} \rangle \\
&amp; = \mu \langle \vec{x}, \vec{y} \rangle.
\end{align*}\]</span> Subtracting the right-hand side from the left hand side we see that <span class="math display">\[\begin{equation*}
(\lambda - \mu) \langle \vec{x}, \vec{y} \rangle = 0.
\end{equation*}\]</span> This implies that if <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\mu\)</span> are distinct, then <span class="math inline">\(\langle \vec{x},
\vec{y} \rangle = 0\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="symmetric-matrices-and-bases" class="slide level3">
<h3>Symmetric matrices and bases</h3>
<div id="cor-evector-basis" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1</strong></span> Let <span class="math inline">\(A\)</span> be a symmetric <span class="math inline">\(n \times n\)</span> matrix with real entries and <span class="math inline">\(n\)</span> distinct eigenvectors. Then the eigenvectors of <span class="math inline">\(A\)</span> form a basis of <span class="math inline">\(\mathbb{R}^n\)</span>.</p>
</div>
<aside class="notes">
<p>We can only give an incomplete proof of this result. We will show that the eigenvectors are linearly independent. The proof is completed by showing that if you have any <span class="math inline">\(n\)</span> linearly independent vectors in <span class="math inline">\(\mathbb{R}^n\)</span> then you must have a basis.</p>
<p>Denote by <span class="math inline">\(\vec{x}^{(1)}, \ldots \vec{x}^{(n)}\)</span> the <span class="math inline">\(n\)</span> eigenvectors of <span class="math inline">\(A\)</span>. We want to show that the eigenvectors are linearly independent. Suppose that we have real numbers <span class="math inline">\(\alpha_1, \alpha_2, \cdots, \alpha_n\)</span> such that: <span class="math display">\[\begin{equation}
\label{eq:evalue-lin}
\sum_{i=1}^n \alpha_i \vec{x}^{(i)} = \vec{0}.
\end{equation}\]</span> To show the eigenvectors are linearly independent, we need to show that all <span class="math inline">\(\alpha_i = 0\)</span>. We can do this by taking the inner product of <span class="math inline">\(\eqref{eq:evalue-lin}\)</span> with <span class="math inline">\(\vec{x}^{(j)}\)</span> for <em>any</em> <span class="math inline">\(j\)</span>: <span class="math display">\[\begin{equation*}
0 = \vec{0} \cdot \vec{x}^{(j)}
= \left(\sum_{i=1}^n \alpha_i \vec{x}^{(i)}\right) \cdot \vec{x}^{(j)}
= \sum_{i=1}^n \alpha_i \left( \vec{x^{(i)}} \cdot \vec{x}^{(j)} \right)
= \alpha_j \vec{x}^{(j)} \cdot \vec{x}^{(j)}.
\end{equation*}\]</span> Since we have that <span class="math inline">\(|\vec{x}^{(j)}| &gt; 0\)</span>, we have <span class="math inline">\(\alpha_j = 0\)</span> and we have shown that the eigenvectors are linearly independent.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="summary-and-whats-next" class="title-slide slide level2 center">
<h2>Summary and what’s next</h2>
<ul>
<li><p>When working with eigenvalue problems it’s important to work with complex matrices and vectors.</p></li>
<li><p>Similar matrices have the same eigenvalues and we have a formula for transferring eigenvectors from one matrix to another similar matrix.</p></li>
<li><p>Real symmetric eigenvalues have real eigenvalues and (if distinct) orthogonal eigenvectors. (Our method will only work for symmetric matrices).</p></li>
</ul>
</section>
<section id="grand-strategy" class="slide level3">
<h3>Grand strategy</h3>
<p>To find eigenvalues and eigenvectors of <span class="math inline">\(A\)</span>, our “grand strategy” is to find a sequence of matrices <span class="math inline">\(P_1, P_2, \ldots\)</span> to form a sequence of matrices: <span class="math display">\[\begin{gather*}
A \\
P_1^{-1} A P \\
P_2^{-1} P_1^{-1} A P_1 P_2 \\
P_3^{-1} P_2^{-1} P_1^{-1} A P_1 P_2 P_3 \\
\ldots
\end{gather*}\]</span> We aim to get all the way to a simple matrix where we read off the eigenvalues and eigenvectors.</p>

<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lec06_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lec06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lec06_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lec06_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="ojs-module-contents">
    eyJjb250ZW50cyI6W119
    </script>
    <script type="module">
    if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
    window._ojs.paths.runtimeToDoc = "../../..";
    window._ojs.paths.runtimeToRoot = "../../../..";
    window._ojs.paths.docToRoot = "..";
    window._ojs.selfContained = false;
    window._ojs.runtime.interpretFromScriptTags();
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>